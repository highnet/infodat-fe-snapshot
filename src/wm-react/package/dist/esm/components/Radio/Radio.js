/* @copyright Stadt Wien - Wiener Melange 200 */
import{s as e}from"../../lit-element-8d7b5fe2.js";import{x as t}from"../../lit-html-34d0b6a8.js";import{FormOption as r}from"../misc/form-option.js";import{dispatchCustomEvent as i}from"../misc/utils.js";import{n as s}from"../../when-741bb8d9.js";import{SharedInfoMixin as o}from"../misc/shared-info.js";import{FormStateManager as a}from"../misc/form-state-manager.js";import{processRadioOptions as l}from"../misc/radio-utils.js";import{ErrorStateController as h}from"../misc/error-state-controller.js";import"../misc/form-wrapper.js";import"../misc/slot.js";import"../../class-map-b15037ef.js";import"../../directive-16e189ed.js";import"../../unsafe-html-4e49b66a.js";import"../misc/error-tracking.js";import"../../form-item.styles-b671e7a9.js";import"../../form.styles-3cb5bbeb.js";import"../../if-defined-d257cee1.js";import"../../live-77c73e47.js";import"../../wiener-melange.bundle.min-ae18d627.js";const n=a(o(r(e)));class c extends n{static properties={...super.properties,hasError:{type:Boolean,reflect:!0},error:{type:String},errormessage:{type:String,attribute:"errormessage"},summaryErrormessage:{type:String,attribute:"summary-errormessage"},info:{type:String},_infoOpen:{type:Boolean},checked:{type:String,reflect:!0},showErrors:{type:Boolean,reflect:!0},validate:{type:Boolean,reflect:!0},_initialCheckedValue:{state:!0},disabled:{type:Boolean,reflect:!0},disabledoptions:{type:String}};constructor(){super(),this.type="radio",this.value="",this.errormessage="",this.summaryErrormessage="",this.hasError=!1,this.showErrors=!1,this.validate=!1,this.error="",this.info=void 0,this._infoOpen=!1,this.checked="",this._initialCheckedValue="",this.disabled=!1,this.disabledoptions="",this._errorController=new h(this)}connectedCallback(){super.connectedCallback?.(),this.hasAttribute("checked")&&(this._initialCheckedValue=this.getAttribute("checked"))}updated(e){if(super.updated?.(e),e.has("checked")&&this.checked){(this.values?.split(";")||[]).indexOf(this.checked)>-1&&(this.value=this.checked,this._setOptionViaAttributes?.(),this._initialCheckedValue||(this._initialCheckedValue=this.checked))}}_handleChange(e){if(this.disabled)return;if(!e||!e.target)return;const t=e.target.value;this.value=t||"",this.checked=t||"",(this.validate||this.showErrors)&&this.checkValidity(),this._internals?.setFormValue(this.value),i(this,"change",{value:this.value,checked:e.target?.checked})}_handleEvent(e){if(e&&e.target&&!e.target.disabled)switch(i(this,e.type,{value:this.value,target:e.target,checked:e.target.checked}),e.type){case"change":this._handleChange(e);break;case"input":this._handleInput?.(e);break;case"focus":this._handleFocus?.(e);break;case"blur":this._handleBlur?.(e)}}checkValidity(){let e="";const t=Array.from(this.shadowRoot?.querySelectorAll("input[type='radio']")||[]),r=t.some((e=>e.checked));return this.required&&!r?(e=this.errormessage||"Bitte wählen Sie eine Option aus",t.forEach((t=>{try{t.setCustomValidity(e)}catch(e){console.warn("Error setting radio validity:",e)}}))):t.forEach((e=>{try{e.setCustomValidity("")}catch(e){console.warn("Error clearing radio validity:",e)}})),e?this._errorController.setError(e):this._errorController.clearError(),e}showError(e){this._errorController.setError(e)}clearError(){this._errorController.clearError()}_performValidation(){if(!0===this.disabled)return"";const e=this.required&&!this.value?this.errormessage||"Bitte wählen Sie eine Option aus":"";if(e){const t=this.shadowRoot?.querySelectorAll('input[type="radio"]');t&&t.forEach((t=>{try{t.setCustomValidity(e)}catch(e){console.warn("Error setting radio validity in _performValidation:",e)}})),this._errorController.setError(e)}else{const e=this.shadowRoot?.querySelectorAll('input[type="radio"]');e&&e.forEach((e=>{try{e.setCustomValidity("")}catch(e){console.warn("Error clearing radio validity in _performValidation:",e)}})),this._errorController.clearError()}return e}reset(){try{const e=this._initialCheckedValue||"";this.value=e,this.checked=e;(this.shadowRoot?.querySelectorAll('input[type="radio"]')||[]).forEach((t=>{t&&(t.checked=t.value===e)})),this._errorController.clearError(),this._internals?.setFormValue(this.value),i(this,"change",{value:this.value,checked:!!e,isReset:!0})}catch(e){console.error("Error in wm-radio reset method:",e)}}formResetCallback(){try{super.formResetCallback?.(),this.reset(),setTimeout((()=>{if(this._items&&this._items.length){const e=Array.from(this._items).find((e=>e.value===this.value));e&&i(e,"change",{value:e.value,checked:!0,isReset:!0})}}),10)}catch(e){console.error("Error in wm-radio formResetCallback:",e)}}setDisabled(e){this.disabled=Boolean(e),e&&this._errorController.clearError();const t=this.shadowRoot?.querySelectorAll('input[type="radio"]');t&&t.forEach((t=>{if(e)t.setAttribute("disabled","");else{const e=t.value;(this.disabledoptions||"").split(";").filter(Boolean).includes(e)?t.setAttribute("disabled",""):t.removeAttribute("disabled")}})),i(this,"disabled-changed",{disabled:this.disabled})}_setOptionViaAttributes(){if(this.labels)try{const e=this.getAttribute("disabledoptions")||"";let t=l({labels:this.labels,values:this.values,disabled:e,type:"radio",checked:this.checked});this.disabled&&(t=t.map((e=>({...e,disabled:!0})))),this.setOptions(t),this.checked&&(this.value=this.checked)}catch(e){console.error(`Error in ${this.tagName} _setOptionViaAttributes:`,e)}}render(){return t`
            ${this._renderItem?.()||""}
            ${s(this.hasInfo,(()=>this._renderInfoButton("--button-min-height:30px; --button-min-width:30px; touch-action: manipulation; --info-button-pos-top:0; --info-button-pos-right:-14px;")))}
            ${s(this.hasInfo,(()=>this._renderInfoText()))}
        `}}customElements.define("wm-radio",c);const d="wm-radio";export{c as Radio,d as tagName};
